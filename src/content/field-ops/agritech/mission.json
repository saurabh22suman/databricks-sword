{
  "industry": "agritech",
  "title": "Precision Agriculture Data Platform",
  "description": "Deploy an end-to-end agricultural intelligence system combining IoT soil sensors, satellite imagery, weather feeds, and irrigation logs. Implement data quality profiling, multi-source joins, and yield prediction features.",
  "difficulty": "expert",
  "estimatedMinutes": 120,
  "xpReward": 2500,
  "objectives": [
    "Implement data quality profiling with Great Expectations for sensor data",
    "Fix broken multi-source joins (sensors + satellite + weather) with incorrect join conditions",
    "Calculate NDVI (Normalized Difference Vegetation Index) from satellite imagery",
    "Build irrigation efficiency metrics with proper time-window aggregations",
    "Create yield prediction features with crop-stage-aware transformations"
  ],
  "technologies": [
    "Great Expectations",
    "Complex Joins",
    "Geospatial Functions",
    "Time Series Windows",
    "Feature Engineering"
  ],
  "scenario": {
    "industry": "Agriculture Technology",
    "challenge": "A precision agriculture platform ingests data from 10,000+ soil sensors, daily satellite imagery (10m resolution), hourly weather feeds, and irrigation system logs. Current pipeline has 15% data quality issues (out-of-range pH values, GPS drift, missing timestamps). Multi-source joins are broken - using INNER JOIN causes 40% data loss. NDVI calculations return negative values due to band reversal. Yield predictions are 28% less accurate than baseline due to feature engineering bugs.",
    "deployment": "5 notebooks + 1 Great Expectations suite + 3 feature tables"
  },
  "validations": [
    {
      "id": "great_expectations_suite",
      "name": "Data Quality Suite Passing",
      "query": "SELECT success_percent FROM great_expectations.validation_results WHERE suite_name = 'soil_sensor_suite' ORDER BY run_time DESC LIMIT 1",
      "expected": 100.0,
      "hint": "Check Great Expectations suite - expectations might be too strict or data needs cleaning"
    },
    {
      "id": "sensor_weather_join",
      "name": "Multi-Source Join Completeness",
      "query": "SELECT COUNT(*) FROM agritech_silver.sensor_weather_enriched WHERE weather_temp_f IS NOT NULL",
      "expected": 950,
      "hint": "Use LEFT JOIN to preserve sensor records when weather data is missing"
    },
    {
      "id": "ndvi_calculation",
      "name": "NDVI Value Range",
      "query": "SELECT MIN(ndvi) as min_ndvi, MAX(ndvi) as max_ndvi FROM agritech_silver.satellite_imagery_processed",
      "expected": "min_ndvi >= -1 AND max_ndvi <= 1",
      "hint": "NDVI = (NIR - Red) / (NIR + Red) - ensure band ordering is correct"
    },
    {
      "id": "irrigation_efficiency",
      "name": "Irrigation Efficiency Metrics",
      "query": "SELECT AVG(water_use_efficiency) FROM agritech_gold.irrigation_summary WHERE crop_type = 'corn'",
      "expected": 0.85,
      "hint": "Water Use Efficiency = (yield / water_applied) - check units and time window aggregation"
    },
    {
      "id": "yield_prediction_features",
      "name": "Yield Prediction Feature Count",
      "query": "SELECT COUNT(DISTINCT feature_name) FROM feature_store.crop_yield_features",
      "expected": 12,
      "hint": "Need features: NDVI_avg, soil_moisture_avg, gdd_cumulative, rainfall_total, etc."
    }
  ],
  "hints": [
    "Great Expectations: Use expect_column_values_to_be_between for sensor ranges (pH: 4-9, moisture: 0-100%)",
    "Multi-source joins: Use LEFT JOIN from sensors, not INNER JOIN (preserves sensor readings even when satellite/weather is missing)",
    "NDVI: Formula is (NIR - Red) / (NIR + Red), ensure NIR is band 8 and Red is band 4 (not reversed)",
    "Geospatial: Use ST_Distance for sensor-to-field matching, not simple lat/long comparison",
    "GDD (Growing Degree Days): Formula is ((Tmax + Tmin) / 2) - Tbase, where Tbase varies by crop"
  ],
  "dataFiles": [
    "soil_sensors.json",
    "satellite_imagery.csv",
    "weather_history.csv",
    "irrigation_logs.csv",
    "field_boundaries.geojson"
  ],
  "notebooks": [
    "01_data_quality_profiling.py",
    "02_multi_source_enrichment.py",
    "03_ndvi_calculation.py",
    "04_irrigation_efficiency.py",
    "05_yield_prediction_features.py"
  ]
}
