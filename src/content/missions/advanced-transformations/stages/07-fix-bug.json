{
  "description": "A running total is calculated across all stores instead of per store. Fix the window definition so running_total is partitioned by store_id and ordered by sale_date.",
  "starterCode": "window_spec = Window.orderBy(\"sale_date\")\ndf = df.withColumn(\"running_total\", F.sum(\"amount\").over(window_spec))",
  "expectedPattern": "window\\.partitionby\\s*\\(\\s*\\\"store_id\\\"\\s*\\)\\s*\\.orderby\\s*\\(\\s*\\\"sale_date\\\"\\s*\\)",
  "simulatedOutput": "Issue: running_total keeps increasing across different stores.",
  "hints": [
    "Use PARTITION BY semantics in the window spec.",
    "Keep ordering by sale_date within each store.",
    "The aggregation function sum(amount) is already correct."
  ]
}
